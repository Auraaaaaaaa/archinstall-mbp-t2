# This is an example PKGBUILD file. Use this as a start to creating your own,
# and remove these comments. For more information, see 'man PKGBUILD'.
# NOTE: Please fill out the license field for your package! If it is unknown,
# then please put 'unknown'.

model=$(echo MODEL)
_model=$(echo $model|tr , _)
chip=$(file FIRMWARE|sed -e 's#.*wifi-fw/C-##' -e 's/__.*//')
pkgname=(apple-t2-wifi-${_model})
pkgver=0.1
pkgrel=1
pkgdesc="Wifi firmware for $model, specific to the computer that firmware was selected for."
arch=("any")
url="https://packages.aunali1.com/apple/wifi-fw/18G2022/"
license=('unknown')
source=("FIRMWARE"
        "REGULATORY"
	"NVRAM")
md5sums=('SKIP'
         'SKIP'
         'SKIP')

prepare() {
	cp -L FIRMWARE brcmfmac$chip-pcie.bin
	cp -L REGULATORY brcmfmac$chip-pcie.clm_blob
	cp -L NVRAM brcmfmac$chip-pcie.Apple\ Inc.-$model.txt
}

package() {
	install -Dm644 -t $pkgdir/usr/lib/firmware/brcm/ brcmfmac????-pcie.bin brcmfmac????-pcie.clm_blob brcmfmac????-pcie.Apple\ Inc.-$model.txt
}
