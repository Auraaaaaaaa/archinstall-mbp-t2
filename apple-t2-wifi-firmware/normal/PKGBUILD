# This is an example PKGBUILD file. Use this as a start to creating your own,
# and remove these comments. For more information, see 'man PKGBUILD'.
# NOTE: Please fill out the license field for your package! If it is unknown,
# then please put 'unknown'.

model=$(echo MODEL)
_model=$(echo $model|tr , _)
chip=$(echo FIRMWARE |sed -e 's/^..//' -e 's/__.*//')
pkgname=(apple-t2-wifi-${_model})
pkgver=0.1
pkgrel=1
pkgdesc="Wifi firmware for $model, specific to the computer that firmware was selected for."
arch=("any")
url="https://packages.aunali1.com/apple/wifi-fw/18G2022/"
license=('unknown')
source=("wifi-fw/FIRMWARE"
        "wifi-fw/REGULATORY"
	"wifi-fw/NVRAM")
md5sums=('SKIP'
         'SKIP'
         'SKIP')

prepare() {
	cp -L *.trx "brcmfmac$chip-pcie.bin"
	cp -L *.clmb "brcmfmac$chip-pcie.clm_blob"
	cp -L *.txt "brcmfmac$chip-pcie.Apple Inc.-$model.txt"
}

package() {
	install -Dm644 -t $pkgdir/usr/lib/firmware/brcm/ "brcmfmac$chip-pcie.bin" "brcmfmac$chip-pcie.clm_blob" "brcmfmac$chip-pcie.Apple Inc.-$model.txt"
}
